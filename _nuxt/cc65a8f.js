(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{460:function(t,e,n){var content=n(580);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(14).default)("4465ed73",content,!0,{sourceMap:!1})},579:function(t,e,n){"use strict";n(460)},580:function(t,e,n){var r=n(13)((function(i){return i[1]}));r.push([t.i,".spinner[data-v-1e8e485b]{animation:spin-1e8e485b .6s ease-out infinite;background:transparent;border:4px solid transparent;border-radius:100%;border-top:2px solid #484efc;box-sizing:border-box;height:30px;margin-bottom:-2px;margin-left:10px;width:30px}@keyframes spin-1e8e485b{to{transform:rotate(1turn)}}.main[data-v-1e8e485b]{margin:10px auto;width:58%}.flex[data-v-1e8e485b]{cursor:pointer;display:flex;margin:8px 0;padding:5px;position:relative}.sold[data-v-1e8e485b]{background-color:hsla(0,0%,78%,.5);border-radius:5px;bottom:0;color:#fff;justify-content:center;left:0;position:absolute;right:0;top:0}.left[data-v-1e8e485b],.sold[data-v-1e8e485b]{align-items:center;display:flex}.left[data-v-1e8e485b]{flex:0 0 90%;gap:2%;max-width:90%}.right[data-v-1e8e485b]{align-items:center;display:flex;flex:0 0 10%;justify-content:flex-end;max-width:10%;opacity:.8;padding:10px 0}.imgdiv[data-v-1e8e485b]{border:1px solid #fff;border-radius:50%;height:4rem;overflow:hidden;width:4rem}.img[data-v-1e8e485b]{height:100%;-o-object-fit:fit;object-fit:fit;width:100%}p[data-v-1e8e485b]{font-size:12px;margin:0;opacity:.8;padding:0}@media only screen and (max-width:1024px){.main[data-v-1e8e485b]{width:90%}p[data-v-1e8e485b]{font-size:12px;margin:0;opacity:.8;padding:0}.imgdiv[data-v-1e8e485b]{height:3rem;width:3rem}}",""]),r.locals={},t.exports=r},859:function(t,e,n){"use strict";n.r(e);var r=n(6),o=(n(39),n(238),n(29),n(17)),d={middleware:["Checkuser1"],data:function(){return{contacts:[],messages:[],newMessage:"",path1:"",tableData:[],activeChat:null,load:!0}},mounted:function(){this.getData()},methods:{dlt:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.collection("chat").delete('"'.concat(t,'"'));case 2:case"end":return e.stop()}}),e)})))()},goto:function(t){1!=t.adSold&&this.$router.push({name:"Chat-id",params:{id:t.id}})},gogoz:function(t){var e=JSON.parse(t.field);return"".concat(this.path1,"/api/files/advertisement/").concat(t.ad_id,"/").concat(e[0])},getData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,d,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t).path1=o.c,d=n.$store.state.phone,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:d})},e.prev=5,e.next=8,fetch("https://selby.in/api/getChats",c);case 8:return l=e.sent,e.next=11,l.json();case 11:f=e.sent,l.ok&&(n.tableData=f.message.response),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(5);case 17:o.a.collection("chat").subscribe("*",function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e){var r,d,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("delete"==e.action&&(n.tableData=n.tableData.filter((function(a){return a.id!=e.record.id}))),"create"==e.action&&n.getData(),"update"!=e.action){t.next=10;break}if(-1==(r=n.tableData.findIndex((function(a){return a.id==e.record.id})))){t.next=10;break}return t.next=7,o.a.collection("chat_msgs").getList(1,1,{filter:"chat_id != ".concat(e.record.id)});case 7:d=t.sent,data={id:n.tableData[r].id,name1:n.tableData[r].name1,name2:n.tableData[r].name2,img:n.tableData[r].img,userImg:n.tableData[r].userImg,adName:n.tableData[r].adName,adPrice:n.tableData[r].adPrice,lastMsg:d.items[0].msg,date:d.items[0].date,read:d.items[0].read,sent_by:d.items[0].sent_by,msg_type:d.items[0].msg_type,adSold:n.tableData[r].adSold},n.tableData[r]=data;case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{}),o.a.collection("chat_msgs").subscribe("*",(function(t){if("create"==t.action){var e=n.tableData.findIndex((function(a){return a.id==t.record.chat_id}));-1!=e&&n.tableData[e].id==t.record.chat_id&&(n.tableData[e].date=t.record.date,n.tableData[e].read=t.record.read,n.tableData[e].sent_by=t.record.sent_by,n.tableData[e].msg_type=t.record.msg_type,n.tableData[e].lastMsg=t.record.msg)}if("update"==t.action){var r=n.tableData.findIndex((function(a){return a.id==t.record.chat_id&&a.lastMsg==t.record.msg}));-1!=r&&n.tableData[r].id==t.record.chat_id&&(n.tableData[r].read=t.record.read)}}),{}),o.a.collection("advertisement").subscribe("*",(function(t){var e=n.tableData.findIndex((function(a){return a.ad_id=t.record.id}));-1!=e&&(n.tableData[e].adSold=t.record.sold,n.tableData[e].adActive=t.record.active,n.tableData[e].adBlock=t.record.block)}),{}),setTimeout((function(){n.load=!1}),1e3);case 21:case"end":return e.stop()}}),e,null,[[5,15]])})))()}},beforeDestroy:function(){o.a.collection("advertisement").unsubscribe("*"),o.a.collection("chat_msgs").unsubscribe("*"),o.a.collection("chat").unsubscribe("*")}},c=d,l=(n(579),n(9)),component=Object(l.a)(c,(function(){var t=this,e=t._self._c;return e("div",[0==t.load?e("div",[0!=t.tableData.length?e("div",{staticClass:"main"},t._l(t.tableData,(function(i,n){return e("div",{key:n,staticClass:"flex"},[e("div",{staticClass:"left",on:{click:function(e){return t.goto(i)}}},[e("div",{staticClass:"imgdiv"},[e("img",{staticClass:"img",attrs:{src:t.gogoz(i),alt:"".concat(t.path1,"/api/files/advertisement/").concat(i.ad_id,"/").concat(i.field[0])}})]),t._v(" "),e("div",{staticClass:"textdiv"},[e("p",[t._v(t._s(i.name2))]),t._v(" "),e("p",[e("strong",[t._v(t._s(i.adName))])]),t._v(" "),e("p",{style:{opacity:i.read?.8:1,fontWeight:i.read?"normal":"bold"}},[t._v("\n              "+t._s(i.msg)+"\n            ")])])]),t._v(" "),e("div",{staticClass:"right",staticStyle:{display:"block"}},[e("span",{on:{click:function(e){return t.dlt(i.id)}}},[e("mdicon",{attrs:{name:"delete-forever"}})],1),t._v(" "),e("br"),t._v(" "),0==i.read&&i.sent_by!=t.$store.state.phone?e("span",{staticStyle:{color:"blue","margin-top":"10px"}},[t._v("\n            New\n          ")]):t._e()]),t._v(" "),e("div",{class:{sold:i.adSold||!i.adActive||i.adBlock}})])})),0):e("div",{staticStyle:{width:"100vw",height:"80vh",display:"flex","justify-content":"center","align-items":"center"}},[e("p",[t._v("No Chats Found")])])]):e("div",{staticStyle:{width:"100vw",height:"80vh",display:"flex","justify-content":"center","align-items":"center"}},[t._m(0)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"notFound"},[t("p",{staticClass:"spinner"})])}],!1,null,"1e8e485b",null);e.default=component.exports}}]);